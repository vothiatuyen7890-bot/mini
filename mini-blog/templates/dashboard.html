{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<h2 class="mb-4">üìä B·∫£ng ƒêi·ªÅu Khi·ªÉn (Dashboard)</h2>

<div class="row">
    <div class="col-md-6 col-lg-3 mb-3">
        <div class="card text-white bg-primary">
            <div class="card-body">
                <h5 class="card-title">üë• T·ªïng s·ªë User</h5>
                <p class="card-text fs-2">{{ total_users }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-lg-3 mb-3">
        <div class="card text-white bg-success">
            <div class="card-body">
                <h5 class="card-title">üìÇ T·ªïng s·ªë File</h5>
                <p class="card-text fs-2">{{ total_files }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-12">
        <h3 class="mt-4">Danh s√°ch T·ªáp Tin c·ªßa b·∫°n ({{ current_user.username }})</h3>
        <a href="{{ url_for('upload_file') }}" class="btn btn-sm btn-outline-primary mb-3">T·∫£i L√™n T·ªáp M·ªõi</a>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>T√™n T·ªáp</th>
                    <th>Ng√†y T·∫£i L√™n</th>
                    <th>H√†nh ƒë·ªông</th>
                </tr>
            </thead>
            <tbody>
                {% for file in user_files %}
                <tr>
                    <td>{{ file.id }}</td>
                    <td><a href="{{ url_for('static', filename='uploads/' + file.filename) }}" target="_blank">{{ file.filename }}</a></td>
                    <td>{{ file.upload_date.strftime('%d/%m/%Y %H:%M') }}</td>
                    <td>
                        <button class="btn btn-sm btn-danger disabled">X√≥a</button>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4">B·∫°n ch∆∞a t·∫£i l√™n t·ªáp n√†o.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <h3 class="mt-4">Th·ª≠ nghi·ªám API (CRUD)</h3>
        <p>Endpoint API c∆° b·∫£n: <code>/api/posts</code></p>
        <p>B·∫°n c√≥ th·ªÉ d√πng c√¥ng c·ª• nh∆∞ Postman ho·∫∑c cURL ƒë·ªÉ ki·ªÉm tra c√°c ph∆∞∆°ng th·ª©c GET, POST, PUT, DELETE.</p>
    </div>
</div>
<!-- Th√™m Danh S√°ch B√†i Vi·∫øt (Posts) -->
        <h3 class="mt-5">Danh s√°ch B√†i Vi·∫øt c·ªßa b·∫°n</h3>
        <a href="{{ url_for('new_post') }}" class="btn btn-sm btn-success mb-3">T·∫°o B√†i Vi·∫øt M·ªõi</a>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Ti√™u ƒë·ªÅ</th>
                    <th>T√°c gi·∫£</th>
                    <th>H√†nh ƒë·ªông</th>
                </tr>
            </thead>
            <tbody>
                <!-- L·∫∑p qua c√°c b√†i vi·∫øt (posts) ƒë√£ ƒë∆∞·ª£c truy·ªÅn t·ª´ app.py -->
                {% for post in user_posts %}
                <tr>
                    <td>{{ post.id }}</td>
                    <td><a href="{{ url_for('view_post', post_id=post.id) }}">{{ post.title }}</a></td>
                    <td>{{ post.author.username }}</td>
                    <td>
                        <a href="{{ url_for('view_post', post_id=post.id) }}" class="btn btn-sm btn-info text-white me-1">Xem</a>
                        <button class="btn btn-sm btn-danger disabled">X√≥a</button>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4">B·∫°n ch∆∞a t·∫°o b√†i vi·∫øt n√†o.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}